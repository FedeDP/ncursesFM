/* TODO:
 * semplify (if possible) search_loop function
 * clean up code
 */
