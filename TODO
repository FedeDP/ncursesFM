/* TODO:
 * semplify (if possible) search_loop function
 */
